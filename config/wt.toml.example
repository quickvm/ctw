# Merge this snippet into your project's .config/wt.toml
# Auto-fetches ticket context when creating a worktree whose branch name
# contains a ticket identifier. Works for Linear (ENG-123) and GitHub (owner-repo-42).
#
# Requires: ctw on PATH, CTW_DEFAULT_TRACKER or CTW_PROVIDER set

[post-create]
ctw-context = """
  # Linear-style: ENG-123
  TICKET=$(echo '{{ branch }}' | grep -oE '[A-Z]+-[0-9]+' | head -1)

  # GitHub-style: owner-repo-42 (requires CTW_GITHUB_REPO set)
  if [ -z "$TICKET" ] && [ -n "$CTW_GITHUB_REPO" ]; then
    NUMBER=$(echo '{{ branch }}' | grep -oE '[0-9]+' | head -1)
    [ -n "$NUMBER" ] && TICKET="${CTW_GITHUB_REPO}#${NUMBER}"
  fi

  if [ -n "$TICKET" ] && command -v ctw &>/dev/null; then
    ctw context "$TICKET" -o TASK.md && echo "Loaded $TICKET â†’ TASK.md"
  fi
"""
